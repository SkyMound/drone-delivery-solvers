package drone_delivery.solver

import io.sarl.api.core.DefaultContextInteractions
import io.sarl.api.core.Initialize
import io.sarl.api.core.Lifecycle
import io.sarl.api.core.Logging
import io.sarl.api.core.Schedules
import java.util.Collection
import java.util.UUID
import org.arakhne.afc.math.geometry.d2.d.Vector2d

enum Objectiv {
	GoLiv,
	BackLiv,
	Charge
}

/** 
 * 
 * 
 */
agent Drone {
	uses Logging, DefaultContextInteractions, Schedules, Lifecycle

	// ID of the environmental agent
	var environment : UUID

	var position : Vector2d

	var speed : Vector2d
	var battery : int 
	var weight : float
	
	var targetPos : Vector2d
	
	var objectiv : Objectiv
	
	var parcel : Parcel

	on Initialize {
		// Drones init parameters : UUID envt, Vector2d initialPosition, Vector2d initialVitesse, String droneName
		if (occurrence.parameters.size > 3) {
			if (occurrence.parameters.get(0) instanceof UUID) {
				environment = occurrence.parameters.get(0) as UUID
			}

			if (occurrence.parameters.get(1) instanceof Vector2d) {
				position = occurrence.parameters.get(2) as Vector2d
			}
			if (occurrence.parameters.get(2) instanceof Vector2d) {
				speed = occurrence.parameters.get(3) as Vector2d
				speed.length = 0.25
				speed += new Vector2d(0, 0.75)
				speed.scale(Settings::DroneMaxSpeed)
			}
			if (occurrence.parameters.get(3) instanceof String) {
				loggingName = occurrence.parameters.get(4) as String
			}

		}
		if (Settings::isLogActivated) {
			"Boids activated".info
		}
		
	}

}
